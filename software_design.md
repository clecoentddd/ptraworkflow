# EventZ Software Design Overview

This document explains how EventZ is used in this application, slice by slice, and describes the compliance of each slice with EventZ principles.

## EventZ Principles Recap
- **Canonical Event Log:** All business changes are recorded as immutable events.
- **F Function (Automation):** Pure function applied after each event append, may generate new events.
- **Projections:** Pure functions that compute state from the event log, never mutate state.
- **Slices:** Vertical features/modules, each with its own events, projections, and automation.

---

## Slices and EventZ Compliance

### 1. Workflow Slice
- **Events:** StepOpened, StepDone, StepCancelled, etc.
- **F Function:** Applied after every event append via `workflowEventLog.js`, triggers automation and step transitions.
- **Projection:** `workflowProjections.js` computes step states from the event log, strictly pure.
- **Compliance:** Fully EventZ compliant. All workflow state is derived from events and projections.

### 2. Payment Plan Slice
- **Events:** PaymentPlanCreated, PaymentPlanAutoGenerated.
- **F Function:** Automation in `paymentPlanAutomation.js` runs after DecisionValidee, generates payment plan events if needed.
- **Projection:** `paymentPlanProjection.js` computes payment plan state from the event log.
- **Compliance:** EventZ compliant. Automation and projections are pure; all state is event-driven.

### 3. Reconciliation Slice
- **Events:** DecisionValidee, PlanDeCalculEffectué, PaiementEffectué, PaiementDemandé.
- **F Function:** Not directly used, but projections (`reconciliationProjection.js`, `useReconciliationValidation.js`) are pure and derive state from the event log.
- **Projection:** Sums all payments per month, links to calculation and payment plan events.
- **Compliance:** EventZ compliant. All reconciliation logic is projection-based and event-driven.

### 4. Finance Tracker Slice
- **Events:** EntryAdded, EntryDeleted.
- **F Function:** Not directly used, but projections are pure and event-driven.
- **Projection:** `EventzFinanceTracker.js` and `computeEntries.js` group entries by month from the event log.
- **Compliance:** EventZ compliant. All finance data is derived from events and projections.

### 5. Droits Period Slice
- **Events:** PeriodesDroitsModifiees.
- **F Function:** Not directly used, but projections (`computeDroitsPeriod.js`, `getAllDroitsPeriods.js`) are pure.
- **Projection:** Computes current and historical droits periods from the event log.
- **Compliance:** EventZ compliant.

---

## F Function Application
- The F function is applied in `workflowEventLog.js` after every event append.
- It triggers automation (e.g., payment plan creation) and ensures all derived events are appended to the log.
- All automation is pure and deterministic.

## Projections
- All projections are pure functions that take the event log and compute current state.
- No projections mutate state; all UI and business logic is derived from projections.

## EventZ Compliance Summary
- All slices are event-driven and use pure projections.
- Automation (F function) is applied consistently.
- No direct state mutation outside of event append.

---

## Next Steps
- See `non-compliance.md` for any areas that need improvement or do not fully comply with EventZ principles.
